<!DOCTYPE html>
<html >
<head>
    <title>ElasticSearch Compatibility - Dactyl: A Heroic Doc Tool</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width">

    <!-- Blocking JS resources -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Stylesheet -->
    <link href="template_assets/dactyl.css" rel="stylesheet" />



    <script>
        $(document).ready(function() {
            $(".multicode").minitabs();
            make_code_expandable();
        });
    </script>

</head>

<body class="sidebar-both  " data-spy="scroll" data-target="#page-toc-wrapper" data-offset="0">
<nav class="navbar fixed-top navbar-expand-lg navbar-light bg-white px-2">
  <a href="/" class="navbar-brand"><h1>Dactyl: A Heroic Doc Tool</h1></a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarHolder" aria-controls="navbarHolder" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse justify-content-end" id="navbarHolder">
    <ul class="nav navbar-nav">
          <li class="nav-item active-parent">
            <a class="nav-link" href="usage.html">Usage</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="features.html">Features</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="filters.html">Filters</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="extending-index.html">Extending Dactyl</a>
          </li>
    </ul><!-- /.navbar-nav -->



  </div><!--/#navbarHolder-->
</nav>
  <div class="container-fluid" role="document" id="main_content_wrapper">
    <div class="row">
      <!-- Right sidebar first so it's at the beginning for mobile layouts -->
      <aside class="right-sidebar col-lg-3 order-lg-4" role="complementary">
<div class="card" id="page-toc-wrapper">
  <div class="card-header">
    <h4>In this page:</h4>
  </div>
  <ul id="page-toc" class="list-group card-body" role="directory">
    <li class="level-1"><a class="nav-link" href="#elasticsearch-compatibility">ElasticSearch Compatibility</a></li>
    <li class="level-2"><a class="nav-link" href="#elasticsearch-json-templates">ElasticSearch JSON Templates</a></li>
  </ul>
</div>      </aside>

      <!-- main column -->
      <main class="main col-md-7 col-lg-6 order-md-3  " role="main" id="main_content_body">
<nav class="breadcrumbs-wrap p-0 p-md-3" aria-label="breadcrumb">
  <ul class="breadcrumb">
    

    <li class="active breadcrumb-item"><a href="index.html">Index</a></li>
    <li class="active breadcrumb-item"><a href="usage.html">Usage</a></li>
    <li class="active breadcrumb-item">ElasticSearch Compatibility</li>
  </ul>
</nav><!--/.breadcrumbs-wrap-->            <section class="pt-3 p-md-3">
              <article class="dactyl-content">
                <h1 id="elasticsearch-compatibility">ElasticSearch Compatibility<a aria-hidden="true" class="hover_anchor" href="#elasticsearch-compatibility">¶</a></h1>
<p>Dactyl has the ability to build JSON formatted for upload to <a href="https://www.elastic.co/products/elasticsearch">ElasticSearch</a> and even upload it directly.</p>
<p>To build JSON files for upload to ElasticSearch, use the <code>--es</code> mode:</p>
<div class="codehilite"><pre><span></span><code>dactyl_build --es
</code></pre></div>
<p>This writes files to the usual output directory using an ElasticSearch JSON template. Dactyl skips any files that do not have a <code>md</code> source parameter in this mode. The output filenames are the pages' <code>html</code> filenames, except ending in <code>.json</code> instead of <code>.html</code>. You can specify a custom template for these JSON files using the top-level <code>default_es_template</code> field in the config file. This template must be a valid JSON file and has several special properties as described in <a href="#elasticsearch-json-templates">ElasticSearch JSON Templates</a>.</p>
<p>Dactyl can also upload these files directly to an ElasticSearch instance, even when building for another mode. For example, to build the HTML version of a target named <code>filterdemos</code> but also upload that target's JSON-formatted data to an ElasticSearch instance:</p>
<div class="codehilite"><pre><span></span><code>dactyl_build -t filterdemos --html --es_upload https://my-es-instance.example.com:9200
</code></pre></div>
<p>The parameter to <code>--es_upload</code> should be the base URL of your ElasticSearch index. You can omit the parameter to use the default base URL of <code>http://localhost:9200</code>.</p>
<h2 id="elasticsearch-json-templates">ElasticSearch JSON Templates<a aria-hidden="true" class="hover_anchor" href="#elasticsearch-json-templates">¶</a></h2>
<p>Dactyl has a special format for JSON templates meant for creating ElasticSearch data. These templates must be valid JSON and are processed according to the following rules:</p>
<ul>
<li>Any strings in the fields' values are "preprocessed" in a similar context to the Jinja2-based Markdown preprocessor. For example, the string <code>ElasticSearch Compatibility</code> evaluates to the page's name.</li>
<li>Any object containing the key <code>__dactyl_eval__</code> is evaluated as a Python expression. The object is replaced with the results of the expression, with lists becoming JSON arrays and dictionaries becoming JSON objects.</li>
<li>The above rules apply recursively to values nested in arrays and objects. All other values are preserved literally.</li>
</ul>
<p>The context provided to the preprocessing and to the <code>__dactyl_eval__</code> expressions is the same and contains the following:</p>
<table>
<thead>
<tr>
<th align="left">Field</th>
<th align="left">Python Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>currentpage</code></td>
<td align="left"><code>dict</code></td>
<td align="left">The current page definition (usually derived from the config file)</td>
</tr>
<tr>
<td align="left"><code>target</code></td>
<td align="left"><code>dict</code></td>
<td align="left">The current target definition (usually derived from the config file)</td>
</tr>
<tr>
<td align="left"><code>categories</code></td>
<td align="left"><code>list</code></td>
<td align="left">A list of unique <code>category</code> values used by pages in the current target, in order of appearance.</td>
</tr>
<tr>
<td align="left"><code>page_filters</code></td>
<td align="left"><code>list</code></td>
<td align="left">A list of the names of Dactyl filters applied to the current page.</td>
</tr>
<tr>
<td align="left"><code>mode</code></td>
<td align="left"><code>str</code></td>
<td align="left">Always equal to <code>es</code> in this context</td>
</tr>
<tr>
<td align="left"><code>current_time</code></td>
<td align="left"><code>str</code></td>
<td align="left">The current time, in the <code>time_format</code> specified in the config. (Defaults to YYYY-MM-DD)</td>
</tr>
<tr>
<td align="left"><code>bypass_errors</code></td>
<td align="left"><code>bool</code></td>
<td align="left">If <code>true</code>, this build is running with the option to continue through errors where possible.</td>
</tr>
</tbody>
</table>
              </article>
            </section>
      </main>
      <!-- Left sidebar last so it's at the end for mobile -->
      <aside class="sidebar col-md-5 col-lg-3 order-md-1" role="complementary">


<nav class="nav flex-column dactyl-tree-nav">
  <div class="nav-item nav-parent">
    <a class="nav-link" href="index.html">Index</a>
  </div>
    
  <div class="nav-item active-parent">


      <a class="nav-toggler " role="button" data-toggle="collapse" href="#tree_nav_group_1" aria-expanded="true" aria-controls="tree_nav_group_1"></a>
    <a class="nav-link" href="usage.html">Usage</a>

    <nav class="nav flex-column show " id="tree_nav_group_1">
      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="config.html">Configuration</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="link-checking.html">Link Checking</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="style-checking.html">Style Checking</a>
  </div>

      
  <div class="nav-item active">
    <a class="nav-link nav-leaf" href="elasticsearch.html">ElasticSearch Compatibility</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="openapi.html">OpenAPI Specifications</a>
  </div>

    </nav>

  </div>

    
  <div class="nav-item ">


      <a class="nav-toggler collapsed" role="button" data-toggle="collapse" href="#tree_nav_group_2" aria-expanded="false" aria-controls="tree_nav_group_2"></a>
    <a class="nav-link" href="features.html">Features</a>

    <nav class="nav flex-column collapse" id="tree_nav_group_2">
      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="code-highlighting.html">Code Highlighting</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="includes.html">Includes</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="frontmatter.html">Frontmatter</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="cli-vars.html">Commandline Variables</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="conditionals.html">Conditionals</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="lists-and-codeblocks.html">Lists and Code Blocks Demo</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="gfm-compat.html">GitHub Markdown Compatibility</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="header_stress_test.html">Header Stress Test</a>
  </div>

      
  <div class="nav-item ">


      <a class="nav-toggler collapsed" role="button" data-toggle="collapse" href="#tree_nav_group_2_9" aria-expanded="false" aria-controls="tree_nav_group_2_9"></a>
    <a class="nav-link" href="virtual-pages.html">Virtual Pages</a>

    <nav class="nav flex-column collapse" id="tree_nav_group_2_9">
      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="https://dactyl.link/#">Dactyl Homepage</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="https://dactyl.link/">Virtual Placeholder</a>
  </div>

    </nav>

  </div>

    </nav>

  </div>

    
  <div class="nav-item ">


      <a class="nav-toggler collapsed" role="button" data-toggle="collapse" href="#tree_nav_group_3" aria-expanded="false" aria-controls="tree_nav_group_3"></a>
    <a class="nav-link" href="filters.html">Filters</a>

    <nav class="nav flex-column collapse" id="tree_nav_group_3">
      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="callouts.html">Callouts Demonstration</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="xrefs.html">Intelligent Cross-References</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="buttonize.html">Buttonize Filter</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="badges.html">Badges</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="multicode_tabs.html">Multi Code-Tabs Filter</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="external_links.html">External Links</a>
  </div>

    </nav>

  </div>

    
  <div class="nav-item ">


      <a class="nav-toggler collapsed" role="button" data-toggle="collapse" href="#tree_nav_group_4" aria-expanded="false" aria-controls="tree_nav_group_4"></a>
    <a class="nav-link" href="extending-index.html">Extending Dactyl</a>

    <nav class="nav flex-column collapse" id="tree_nav_group_4">
      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="templates.html">Templates</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="hierarchy.html">Hierarchy Demo</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="filter-examples-patriots.html">Custom Filter</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="filter-examples-patriots2.html">Custom Filter 2</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="include_code.html">Code Includer</a>
  </div>

      
  <div class="nav-item ">
    <a class="nav-link nav-leaf" href="debug.html">Debug</a>
  </div>

    </nav>

  </div>

</nav>      </aside>
    </div><!--/.row (main layout)-->
  </div>

<footer class="dactyl-footer px-2" role="contentinfo">

  <section class="container-fluid p-5 pl-sm-0">


    <div class="absolute_bottom_footer">
    </div><!-- /.absolute_bottom_footer -->

  </section>
</footer>

<!-- Jump to top button -->
<a href="#main_content_wrapper" class="jump-to-top btn btn-primary btn-lg" role="button" title="Return to top of page">Top</a>
<!-- Non-blocking resources -->
<!-- Bootstrap JS -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
<!-- Dactyl JS -->
<script src="https://dactyl.link/template_assets/dactyl.js"></script>
<!-- fontawesome icons -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />

</body>
</html>